# LDG-01 — t_entity_crud Service Overview

## 1. Purpose
The `t_entity_crud` service is the canonical template for all NV entity-based microservices.  
It defines the standard rails for CRUD operations using the DTO-first architecture.

## 2. Responsibilities
- Expose CRUD API for a single DTO type.
- Enforce shared S2S auth.
- Use shared handlers, pipelines, and DtoBag flows.
- Maintain deterministic index hints.
- Provide a reference structure for cloned services.

## 3. API Surface (v1)
All inbound paths follow the pattern:

```
/api/<slug>/v1/<dtoType>/<action>
```

### Endpoints
- `PUT /create`
- `PATCH /update`
- `GET /read/:id`
- `DELETE /delete/:id`
- `GET /list`
- `POST /query` (optional)

## 4. Pipeline Flow
- Health route
- verifyS2S
- body parser
- controller
- handler pipeline (validate → dto → repo → response)

## 5. DTO Rules
- DTO contract defines schema and index hints.
- No persistence outside DTO shape.
- `_id` is UUID v4, generated by the creator.
- DTO maps directly from domain → persistence.

## 6. Persistence Model
- MongoDB collection determined by env-service.
- Uses DbWriter/DbReader with deterministic collection naming.
- Indexes built at boot.

## 7. Smoke Test Expectations
- Health always 200.
- All CRUD flows deterministic.
- Duplicate create (Test 3) returns the correct duplicate-by-content behavior.
- Read/List pathways use DTO-only persistence.

## 8. Summary
`t_entity_crud` is the backbone template for all entity CRUD services, enforcing NV’s shared architecture, pipelines, and DTO-only persistence model.
